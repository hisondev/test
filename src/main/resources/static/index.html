<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="hison.js"></script>
    <script src="dataModel.js"></script>
    <script src="dataLink.js"></script>
    <script>
        Hison.data.custom.convertObject = function(object) {
            if (object instanceof Date) {
                var year = object.getFullYear();
                var month = object.getMonth() + 1;
                var day = object.getDate();
                var hour = object.getHours();
                var minute = object.getMinutes();
                var second = object.getSeconds();
                month = month < 10 ? '0' + month : month;
                day = day < 10 ? '0' + day : day;
                hour = hour < 10 ? '0' + hour : hour;
                minute = minute < 10 ? '0' + minute : minute;
                second = second < 10 ? '0' + second : second;
                return year + '-' + month + '-' + day + " " + hour + ":" + minute + ":" + second;
            }
            return object;
        }

        // JavaScript fetch API
        async function test1() {
            // private Long id;
            // private String deptcode;
            // private String membername;
            // private String email;
            // private LocalDateTime regdate;
            const arr = [
                            {
                                id : 1,
                                membername: "hani2",
                                email: "hani2@example.com",
                                deptcode: "FN",
                                regdate : new Date(),
                            },
                            {
                                id : 2,
                                membername: "hani3",
                                email: "hani3@example.com",
                                deptcode: "HR",
                                regdate : new Date(),
                                test : "1111",
                            },
                            {
                                id : 3,
                                membername: "hani3",
                                email: "hani4@example.com",
                                deptcode: "HR",
                                regdate : new Date(),
                                test : "2222",
                            },
                            {
                                id : 4,
                                membername: "hani4",
                                email: "hani5@example.com",
                                deptcode: "HR",
                                regdate : new Date(),
                            },
                            {
                                id : 5,
                                membername: "hani5",
                                email: "hani6@example.com",
                                deptcode: "HR",
                                regdate : new Date(),
                                test : null,
                            },
                        ];
            const dm = newDataModel(arr);
            const dw = newDataWrapper("key1", dm);
            dw.put("key2", null);
            dw.put({"key3":"test!!"});
            var dl = newDataLink("MemberService.getMember");

            dl.post(dw,
            function(data, response) {
                console.log("### post function success ###")
                console.log("response is : ", response);
                console.log("result data is : ", data.getType && data.getType() === "datawrapper" ? data.getObject() : data);
                console.log("### post function success ###")
            },
            function (error) {
                console.log("### post function error ###")
                console.log("error is : ", error);
                console.log("### post function error ###")
            }, {timeout:2000});

            newDataLink().get("api/members",
            function(data, response) {
                console.log("### get function success ###")
                console.log("response is : ", response);
                console.log("result data is : ", data.getType && data.getType() === "datawrapper" ? data.getObject() : data);
                console.log("### get function success ###")
            },
            function (error) {
                console.log("### post function error ###")
                console.log("error is : ", error);
                console.log("### post function error ###")
            }, {timeout:2000});
        }

        async function test2() {
            
            // private Long id;
            // private String deptcode;
            // private String membername;
            // private String email;
            // private LocalDateTime regdate;
            const testData1 = {
                "key1" : newDataModel([
                    {
                        id : 5,
                        membername: "hani10",
                        email: "hani2@example.com",
                        deptcode: "FN",
                        regdate : "2023-10-17 18:00:00",
                        test1 : new Date(),
                        test2 : [1,2,3,4,5]
                    },
                    {
                        id : 2,
                        membername: "hani2",
                        email: "hani3@example",
                        deptcode: "HR",
                        regdate : "2023-10-18 18:00:00",
                        test1 : new Date(),
                        test2 : [6,7,8,9,10]
                    }
                ]),
                "key2" : "test",
                // "key3" : new Date(),
            }

            var dw0 = newDataWrapper();
            dw0.put("key1","test1");
            dw0.put("key2","test2");
            console.log(dw0.getObject());

            return;
        }
    </script>
</head>
<body>
    <h2>Hello Spring Boot</h2>
    <br>
    <button onclick="test1()">test go1</button>
    <button onclick="test2()">test go2</button>
    <button onclick="test3()">test go3</button>
</body>
</html>
